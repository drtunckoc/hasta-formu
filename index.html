<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dr. Tunç Koç - Klinik Anamnez Sistemi</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- AYARLAR: YENİ ALDIĞINIZ ANAHTARI BURAYA YAZIN ---
        const API_KEY = "AIzaSyBHGyHJk3s2gkGGkPIFm0HmH2crRb7uQQs"; 
        const DOKTOR_TEL = "905433506012"; 

        const App = () => {
            const [step, setStep] = useState(1);
            const [loading, setLoading] = useState(false);
            const [formData, setFormData] = useState({
                adSoyad: '', yas: '', boy: '', kilo: '', meslek: '', sehir: '', tel: '',
                sikayetler: [], sikayetIlk: '', sikayetArtis: '', agriKarakter: '',
                yurumeMesafesi: '', geceAgrisi: 'Hayır', acilDurum: 'Hayır',
                omurgaIlaclar: '', fizikTedavi: 'Hayır', fizikTedaviFayda: '',
                girisimselTedavi: 'Hayır', girisimselDetay: '',
                ameliyat: 'Hayır', ameliyatDetay: '', sonFilm: '', genelSaglik: '', 
                kanSulandirici: 'Hayır', kanSulandiriciAd: '', tumIlaclar: ''
            });
            const [aiSummary, setAiSummary] = useState('');

            const update = (f, v) => setFormData(p => ({ ...p, [f]: v }));
            const toggle = (i) => {
                const list = formData.sikayetler.includes(i) ? formData.sikayetler.filter(x => x !== i) : [...formData.sikayetler, i];
                update('sikayetler', list);
            };

            const generateAI = async () => {
                setLoading(true);
                try {
                    // 2026 GÜNCELLEMESİ: v1 sürümü ve gemini-3-flash model ismi
                    const res = await fetch(`https://generativelanguage.googleapis.com/v1/models/gemini-3-flash:generateContent?key=${API_KEY}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: `Sen bir omurga cerrahı asistanısın. Aşağıdaki verileri profesyonel bir tıbbi özet yap: Hasta: ${formData.adSoyad}, ${formData.yas}y. Şikayet: ${formData.sikayetler.join(', ')}. Ameliyat: ${formData.ameliyatDetay}. Kan Sulandırıcı: ${formData.kanSulandiriciAd}.` }] }] })
                    });
                    const data = await res.json();
                    if (data.candidates) {
                        setAiSummary(data.candidates[0].content.parts[0].text);
                    } else { throw new Error(); }
                } catch (e) {
                    setAiSummary("AI Özeti şu an meşgul, detaylar aşağıda maddeler halindedir.");
                }
                setStep(6);
                setLoading(false);
            };

            const shareWhatsApp = () => {
                const text = `*HASTA ANALİZİ*\n\n*Özet:* ${aiSummary}\n\n*VERİLER:* ${formData.adSoyad}, ${formData.yas}y\n-Şikayet: ${formData.sikayetler.join(', ')}\n-İlaçlar: ${formData.tumIlaclar}`;
                window.open(`https://wa.me/${DOKTOR_TEL}?text=${encodeURIComponent(text)}`);
            };

            return (
                <div className="max-w-2xl mx-auto p-4 md:p-8 bg-white min-h-screen">
                    {/* Form adımları buraya gelecek... */}
                    <div className="bg-slate-900 p-6 rounded-t-3xl text-white">
                        <h1 className="text-xl font-bold">Dr. Tunç Koç Anamnez Formu</h1>
                        <p className="text-xs opacity-50">Adım {step} / 6</p>
                    </div>
                    
                    <div className="p-6 border rounded-b-3xl shadow-lg">
                        {step === 1 && (
                            <div className="space-y-4">
                                <h2 className="font-bold">Kişisel Bilgiler</h2>
                                <input type="text" placeholder="Ad Soyad" className="w-full p-4 border rounded-xl" onChange={e => update('adSoyad', e.target.value)} />
                                <input type="number" placeholder="Yaş" className="w-full p-4 border rounded-xl" onChange={e => update('yas', e.target.value)} />
                                <button onClick={() => setStep(2)} className="w-full bg-blue-600 text-white p-4 rounded-xl font-bold">İLERİ</button>
                            </div>
                        )}
                        {/* Diğer adımlar (2-5) buraya eklenecek... */}
                        {step === 6 && (
                            <div className="space-y-6">
                                <div className="p-4 bg-blue-50 border-2 border-dashed rounded-2xl italic text-sm leading-relaxed">"{aiSummary}"</div>
                                <button onClick={shareWhatsApp} className="w-full bg-[#25D366] text-white p-5 rounded-2xl font-bold">WHATSAPP İLE GÖNDER</button>
                                <button onClick={() => window.print()} className="w-full bg-slate-900 text-white p-5 rounded-2xl font-bold">YAZDIR (A4)</button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
